# SpringBoot - transaction



## 开启事务

使用@Transactional注解，该注解可以用在类上或方法上，用在类上相当于给类中每个方法都加上@Transactional注解

spring声明式事务原理是通过AOP生成代理对象，代理对象中加入事务控制逻辑。

## 事务失效场景

1. 调用同一类中的方法：例如
   1. A类中有a和b方法都使用@Transactional注解，a方法中调用了b方法，当调用a或b方法时事务都生效
   2. A类中有a和b方法，a方法使用@Transactional注解，b方法没有；a中调用b，事务生效，b中调用a事务不生效

2. 异常未抛出：事务回滚需要捕捉异常，如果手动捕捉了异常而不抛出异常，就不会回滚
3. 方法必须是public的



## 事务隔离级别

事务隔离级别越高，安全性越高，性能越差

多线程环境下，A事务中未提交的数据，能否在其他事务中查询到？

根据不同的事务隔离级别，有不同的情况



















一条批量处理的sql，如果其中一条数据执行失败，是否会影响其他数据的执行









[(转)Spring事务失效的原因(7个) - 简书 (jianshu.com)](https://www.jianshu.com/p/4120b89190d0)



[一口气怼完12种@Transactional的失效场景 - 掘金 (juejin.cn)](https://juejin.cn/post/7047515900903161892)

























































目的：保证数据一致性

本质是AOP

spring支持编程式事务管理和声明式事务管理两种方式。

事务有哪些级别

分布式事务

微服务事务